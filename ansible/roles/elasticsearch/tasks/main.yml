---
- name: download {{ url }}
  run_once: true
  get_url:
    url: "{{ url }}"
    dest: "{{ download }}/{{ file }}"
    checksum: "{{ checksum }}"

- name: install {{ download }}/{{ file }}
  become: yes
  yum:
    name: "{{ download }}/{{ file }}"
    state: present
  notify: "restart elasticsearch"

- name: copy elasticsearch.yml to /etc/elasticsearch/elasticsearch.yml
  become: yes
  template:
    src: templates/elasticsearch.yml.j2
    dest: /etc/elasticsearch/elasticsearch.yml
  notify: "restart elasticsearch"

- name: run handlers
  meta: flush_handlers
